"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var Currency,request=require("request"),queryString=require("querystring"),CryptoJS=require("crypto-js"),__assign=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var a in r=arguments[n])Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a]);return e};!function(e){e.BTC="BTC",e.ETH="ETH",e.DASH="DASH",e.LTC="LTC",e.ETC="ETC",e.XRP="XRP",e.BCH="BCH",e.XMR="XMR",e.ZEC="ZEC",e.QTUM="QTUM",e.BTG="BTG",e.EOS="EOS",e.ICX="ICX",e.VEN="VEN",e.TRX="TRX",e.ELF="ELF",e.MITH="MITH",e.MCO="MCO",e.OMG="OMG",e.KNC="KNC",e.GNT="GNT",e.HSR="HSR",e.ZIL="ZIL",e.ETHOS="ETHOS",e.PAY="PAY",e.WAX="WAX",e.POWR="POWR",e.LRC="LRC",e.GTO="GTO",e.STEEM="STEEM",e.STRAT="STRAT",e.KRW="KRW"}(Currency||(Currency={}));var Currency$1=Currency,Bithumb=function(){function d(){}return d.setApiKey=function(e,r){d._apiKey=e,d._apiSecretKey=r},d.makeAuthenticationHeaders=function(e,r){var n=Date.now(),t=d._apiKey,a=d._apiSecretKey,o=String.fromCharCode(0),i=""+e+o+queryString.stringify(r)+o+n;return{"Api-Key":t,"Api-Sign":Buffer.from(CryptoJS.HmacSHA512(i,a).toString()).toString("base64"),"Api-Nonce":n}},d.purchaseOrder=function(e,r,n,t){return d.order("bid",e,r,n,t)},d.saleOrder=function(e,r,n,t){return d.order("ask",e,r,n,t)},d.purchaseOrderAtMarkerPrice=function(n,a,o){return new Promise(function(t){var e="/trade/market_buy",r={order_currency:n,payment_currency:o,units:a};request.post({url:""+d._apiUrl+e,json:!0,headers:__assign({},d.makeAuthenticationHeaders(e,r)),form:r},function(e,r,n){t([e,r,n])})})},d.saleOrderAtMarketPrice=function(n,a,o){return new Promise(function(t){var e="/trade/market_sell",r={order_currency:n,payment_currency:o,units:a};request.post({url:""+d._apiUrl+e,json:!0,headers:__assign({},d.makeAuthenticationHeaders(e,r)),form:r},function(e,r,n){t([e,r,n])})})},d.cancelPurchaseOrder=function(e,r,n){return void 0===n&&(n=Currency$1.KRW),d.cancelOrder("bid",e,r,n)},d.cancelSaleOrder=function(e,r,n){return void 0===n&&(n=Currency$1.KRW),d.cancelOrder("ask",e,r,n)},d.getPurchaseOrderStatus=function(e,r,n,t){return d.getIncompleteOrders("bid",e,r,n,t)},d.getSaleOrderStatus=function(e,r,n,t){return d.getIncompleteOrders("ask",e,r,n,t)},d.getPurchaseOrderResult=function(e,r,n,t){return d.getCompletedOrders("bid",e,r)},d.getSaleOrderResult=function(e,r,n,t){return d.getCompletedOrders("ask",e,r,n,t)},d.getMyBalance=function(n){return void 0===n&&(n="ALL"),new Promise(function(t){var e="/info/balance",r={currency:n,endpoint:encodeURIComponent(e)};request.post({url:""+d._apiUrl+e,json:!0,headers:__assign({},d.makeAuthenticationHeaders(e,r)),form:r},function(e,r,n){t([e,r,n])})})},d.getMyAccount=function(n){return void 0===n&&(n="ALL"),new Promise(function(t){var e="/info/account",r={order_currency:n,endpoint:encodeURIComponent(e)};request.post({url:""+d._apiUrl+e,json:!0,headers:__assign({},d.makeAuthenticationHeaders(e,r)),form:r},function(e,r,n){t([e,r,n])})})},d.getMyWalletAddress=function(n){return new Promise(function(t){var e="/info/wallet_address",r={currency:n,endpoint:encodeURIComponent(e)};request.post({url:""+d._apiUrl+e,json:!0,headers:__assign({},d.makeAuthenticationHeaders(e,r)),form:r},function(e,r,n){t([e,r,n])})})},d.getMyLatestTransactionHistory=function(n){return new Promise(function(t){var e="/info/wallet_address",r={order_currency:n,endpoint:encodeURIComponent(e),payment_currency:"KRW"};request.post({url:""+d._apiUrl+e,json:!0,headers:__assign({},d.makeAuthenticationHeaders(e,r)),form:r},function(e,r,n){t([e,r,n])})})},d.sendToWallet=function(n,a,o,i){return new Promise(function(t){var e="/trade/btc_withdrawal",r={address:o,destination:i,units:a,currency:n,endpoint:encodeURIComponent(e)};request.post({url:""+d._apiUrl+e,json:!0,headers:__assign({},d.makeAuthenticationHeaders(e,r)),form:r},function(e,r,n){t([e,r,n])})})},d.withdrawAccount=function(n,a,o){return new Promise(function(t){var e="/info/krw_withdrawal",r={account:a,bank:n,price:o,endpoint:encodeURIComponent(e)};request.post({url:""+d._apiUrl+e,json:!0,headers:__assign({},d.makeAuthenticationHeaders(e,r)),form:r},function(e,r,n){t([e,r,n])})})},d.cancelOrder=function(n,a,o,i){return void 0===i&&(i=Currency$1.KRW),new Promise(function(t){var e="/trade/cancel",r={type:n,order_id:o,apiKey:d._apiKey,secretKey:d._apiSecretKey,currency:a,payment_currency:i};request.post({url:""+d._apiUrl+e,json:!0,headers:__assign({},d.makeAuthenticationHeaders(e,r)),form:r},function(e,r,n){t([e,r,n])})})},d.order=function(n,a,o,i,u){return void 0===u&&(u=Currency$1.KRW),new Promise(function(t){var e="/trade/place",r={type:n,price:o,order_currency:a,units:i,payment_currency:u};request.post({url:""+d._apiUrl+e,json:!0,headers:__assign({},d.makeAuthenticationHeaders(e,r)),form:r},function(e,r,n){t([e,r,n])})})},d.getIncompleteOrders=function(n,a,o,i,e,u){void 0===i&&(i=100),void 0===u&&(u=Currency$1.KRW);var c=e?e.getTime():864e4;return new Promise(function(t){var e="/info/orders",r={type:n,after:c,count:i,order_id:o,order_currency:a,payment_currency:u,endpoint:encodeURIComponent(e)};request.post({url:""+d._apiUrl+e,json:!0,headers:__assign({},d.makeAuthenticationHeaders(e,r)),form:r},function(e,r,n){t([e,r,n])})})},d.getCompletedOrders=function(n,a,o,i,e,u,c){void 0===i&&(i=100),void 0===u&&(u=!0),void 0===c&&(c=Currency$1.KRW);var s=e?e.getTime():864e4;return new Promise(function(t){var e="/info/order_detail",r={type:n,after:s,count:i,order_id:o,order_currency:a,payment_currency:c,endpoint:encodeURIComponent(e)};request.post({url:""+d._apiUrl+e,json:!0,headers:__assign({},d.makeAuthenticationHeaders(e,r)),form:r},function(e,r,n){n&&n.data&&u&&(1===n.data.length?(n.data=n.data[0],n.data.units_traded=parseFloat(n.data.units_traded),n.data.price=parseInt(n.data.price,10),n.data.fee=parseFloat(n.data.fee),n.data.total=parseInt(n.data.total,10)):n.data=n.data.reduce(function(e,r){return r?{units_traded:parseFloat(e.units_traded)+parseFloat(r.units_traded),price:parseInt(e.price,10),fee:parseFloat(e.fee)+parseFloat(r.fee),total:parseInt(e.total,10)+parseInt(r.total,10)}:e})),t([e,r,n])})})},d._apiUrl="https://api.bithumb.com",d._apiKey="Enter your API Key",d._apiSecretKey="Enter your API Secret Key",d}(),Utils=function(){function e(){}return e.adjustPrice=function(e){var r=0,n=0;return 1e6<=e?(n=1e3-(r=e%1e3),e+(500<=r?+n:-r)):5e5<=e?(n=500-(r=e%500),e+(250<=r?+n:-r)):1e5<=e?(n=100-(r=e%100),e+(50<=r?+n:-r)):1e4<=e?(n=10-(r=e%10),e+(5<=r?+n:-r)):1e3<=e?(n=5-(r=e%5),e+(2.5<=r?+n:-r)):e},e.toFixed=function(e,r){return void 0===r&&(r=4),parseFloat(e.toFixed(r))},e.bithumbApiResponseCodeToString=function(e){switch(e){case"5100":return"Bad Request";case"5200":return"Not Member";case"5300":return"Invalid Apikey";case"5302":return"Method Not Allowed";case"5400":return"Database Fail";case"5500":return"Invalid Parameter";case"5600":return"Output a contextual message";case"5900":return"Unknown Error";case"0000":return"Success";default:return"Unknown"}},e}();exports.Bithumb=Bithumb,exports.Utils=Utils,exports.Currency=Currency$1;
